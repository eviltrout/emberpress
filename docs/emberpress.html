<!DOCTYPE html>  <html> <head>   <title>emberpress.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               emberpress.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h2>EmberPress</h2>

<p>This is a clone of the popular <a href="https://itunes.apple.com/ca/app/letterpress-word-game/id526619424?mt=8">Letterpress</a>
game. It is meant to show off the client side powers of the <a href="http://emberjs.org">EmberJS</a>
framework and was originally created for <a href="http://torontoemberjs.com">Toronto EmberJS</a>
meetup by <a href="http://eviltrout.com">Evil Trout</a>.</p>

<p>Mucho thanks go out Loren Brichter for the inspiration. Thanks to the EmberJS
team for making an awesome framework that makes client side development fun.
The dictionary was imported from <a href="http://dreamsteep.com/projects/the-english-open-word-list.html">EOWL</a>.
The icons are from <a href="http://fortawesome.github.com/Font-Awesome">Font Awesome</a>.</p>

<p>The complete source code can be found on <a href="https://github.com/eviltrout/emberpress">Github</a>.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h2>EmberPress source code</h2>             </td>             <td class="code">               <div class="highlight"><pre><span class="cm">/*global window, Ember, $, EmberPressDictionary, alert*/</span>
<span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="s1">&#39;use strict&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>All Ember applications need to be an instance of <code>Ember.Application</code>.
We'll create this first so that we can use it as a namespace for all
our models, controllers and views.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">EmberPress</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">EmberPress</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Application</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
    <span class="nx">rootElement</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">)</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h2>Models</h2>

<p>Our models are delcared as extensions of <code>Ember.Object</code>. We use models
to organize our data.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p><strong>Letter:</strong> A simple object to represent a letter on the board.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Letter</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({});</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p><strong>Word:</strong> A word that has been played in the game.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Word</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p><strong>Player:</strong> A player of the game. There will be two instances
of this, for p1 and p2.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Player</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Players start with a score of 0.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">score</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>During a turn, all scores are automatically updated to show
how they will be affected should the player finished their
turn. We consider this the <code>possibleScore</code>. After their turn
is made, it will be saved in <code>score</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">possibleScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>If it's a player's turn, their <code>possibleScore</code> is their
previous score plus the sum of the letters they've chosen.
If it's not a player's turn, their <code>possibleScore</code> is their
previous score minus the letters the current player has
stolen from them.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;isTurn&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board.score&#39;</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">-=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board.stolenScore&#39;</span><span class="p">);</span>
      <span class="p">}</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;board.score&#39;</span><span class="p">,</span> <span class="s1">&#39;board.stolenScore&#39;</span><span class="p">,</span> <span class="s1">&#39;isTurn&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Is it this player's turn?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">isTurn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board.currentPlayer&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;board.currentPlayer&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>When a turn finishes, <code>updateScore()</code> is called to make
the <code>possibleScore</code> permanent.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">updateScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;possibleScore&#39;</span><span class="p">));</span>
    <span class="p">}</span>

  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p><strong>Board:</strong> The current game board and all associated data.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Board</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nb">Object</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>The dimensions of the board. It's always square so we just need
one size.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">SIZE</span><span class="o">:</span> <span class="mi">5</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Start a new game on the board.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">restart</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>When a game begins, there is no winner.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;winner&#39;</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>There are two players. We'll identify them as <em>p1</em> and <em>p2</em></p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;player1&#39;</span><span class="p">,</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Player</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;p1&#39;</span><span class="p">,</span> <span class="nx">board</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;player2&#39;</span><span class="p">,</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Player</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span><span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;p2&#39;</span><span class="p">,</span> <span class="nx">board</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>The first turn always goes to <em>p1</em></p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player1&#39;</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Clear the current word being built by the players.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">clearWord</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p><code>played</code> is a list of all previously played words.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;played&#39;</span><span class="p">,</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">A</span><span class="p">());</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p><code>rows</code> is the collection of rows that make up the board.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span><span class="p">,</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">A</span><span class="p">());</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Assemble a board of random <code>letter</code>s. Each <code>letter</code> is given a random
uppercase ascii character and an id to identify it.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">letterId</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">j</span><span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="p">;</span> <span class="nx">j</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">A</span><span class="p">();</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">letter</span> <span class="o">=</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Letter</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
            <span class="nx">id</span><span class="o">:</span> <span class="nx">letterId</span><span class="p">,</span>
            <span class="nx">letter</span><span class="o">:</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mi">65</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">round</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">25</span><span class="p">))</span>
          <span class="p">});</span>
          <span class="nx">row</span><span class="p">.</span><span class="nx">pushObject</span><span class="p">(</span><span class="nx">letter</span><span class="p">);</span>
          <span class="nx">letterId</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">.</span><span class="nx">pushObject</span><span class="p">(</span><span class="nx">row</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>The game has history once at least one word has been played. We use this
to determine whether to show the list of previous words at the bottom of
the interface.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">hasHistory</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;played&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;played.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Add a letter to the word being built.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">addLetter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">pushObject</span><span class="p">(</span><span class="nx">letter</span><span class="p">);</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Remove a letter from the word being built.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">removeLetter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">removeObject</span><span class="p">(</span><span class="nx">letter</span><span class="p">);</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Remove all letters from the word.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">clearWord</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">,</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">A</span><span class="p">());</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Switch to the next player's turn and clear the current word in progress.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">nextTurn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">clearWord</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;otherPlayer&#39;</span><span class="p">));</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Our current word is a collection of <code>Letter</code> instances. This property
returns the word as a string.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">wordAsString</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">+=</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;letter&#39;</span><span class="p">);</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;word.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p><code>otherPlayer</code> is a reference to the <code>Player</code> who currently isn't taking
their turn.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">otherPlayer</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player1&#39;</span><span class="p">))</span> <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player2&#39;</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player1&#39;</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>If the current word is being made up of letters belonging to the other player,
we consider them stolen. To correctly display the other player's possible score
we need to calculate how many points have been stolen.
fortified letters cannot be stolen.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">stolenScore</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="nx">otherPlayer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;otherPlayer&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="nx">otherPlayer</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;fortified&#39;</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;word.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>The score of the current word. Each <code>Letter</code> is worth one point if it doesn't belong
to the player making the movie and it hasn't been foritifed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">score</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
          <span class="nx">currentPlayer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="nx">currentPlayer</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="o">!</span><span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;fortified&#39;</span><span class="p">)))</span> <span class="p">{</span>
          <span class="nx">result</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
      <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;word.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Finish the current game.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">finishGame</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">resigned</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>If a player resigned, the other player automatically wins.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">resigned</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;winner&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;otherPlayer&#39;</span><span class="p">));</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Otherwise, the winner is simply the player with the larger score.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="kd">var</span> <span class="nx">diff</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player1.score&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player2.score&#39;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;winner&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player1&#39;</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">diff</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;winner&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;player2&#39;</span><span class="p">));</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Submit the current word in play.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">submitWord</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>We call <code>updateScore</code> on both players to make their <code>possibleScore</code>s
permanent.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">currentPlayer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">);</span>
      <span class="nx">currentPlayer</span><span class="p">.</span><span class="nx">updateScore</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;otherPlayer&#39;</span><span class="p">).</span><span class="nx">updateScore</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Give ownership of each <code>Letter</code> in the word to the current player unless the
<code>Letter</code> is fortitied.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;word&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">letter</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Change the color unless it's fortified</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;fortified&#39;</span><span class="p">))</span> <span class="p">{</span>
          <span class="nx">letter</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;owner&#39;</span><span class="p">,</span> <span class="nx">currentPlayer</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>We need to iterate through every <code>Letter</code> on the board to determine if they
are fortified. During this iteration, we also determine whether every <code>Letter</code>
has a colour. If so, the game is over.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">boardFull</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">y</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">y</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="p">;</span> <span class="nx">y</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">x</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">x</span><span class="o">&lt;</span><span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
          <span class="kd">var</span> <span class="nx">letter</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">[</span><span class="nx">y</span><span class="p">][</span><span class="nx">x</span><span class="p">];</span>
          <span class="kd">var</span> <span class="nx">owner</span> <span class="o">=</span> <span class="nx">letter</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner.id&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>By default we remove fortification (it will be applied again if still valid.)</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="nx">letter</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;fortified&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>

          <span class="k">if</span> <span class="p">(</span><span class="nx">owner</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Check the NESW neighbors of the tile</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span> <span class="p">((</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">[</span><span class="nx">y</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="nx">x</span><span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner.id&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">owner</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">((</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">[</span><span class="nx">y</span><span class="o">+</span><span class="mi">1</span><span class="p">][</span><span class="nx">x</span><span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner.id&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">owner</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">((</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">[</span><span class="nx">y</span><span class="p">][</span><span class="nx">x</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner.id&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">owner</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">((</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">SIZE</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">rows</span><span class="p">[</span><span class="nx">y</span><span class="p">][</span><span class="nx">x</span><span class="o">+</span><span class="mi">1</span><span class="p">].</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;owner.id&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="nx">owner</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>If all neighbours are the same colour, fortify it.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">letter</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;fortified&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>If a single tile has no owner, we don't consider the board full.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">boardFull</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Add the word to the played list</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;played&#39;</span><span class="p">).</span><span class="nx">addObject</span><span class="p">(</span><span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Word</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
        <span class="nx">value</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;wordAsString&#39;</span><span class="p">),</span>
        <span class="nx">playedBy</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;currentPlayer&#39;</span><span class="p">)</span>
      <span class="p">}));</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>If the board is full, finish the game.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">boardFull</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">finishGame</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Otherwise, skip to the next player's turn.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">nextTurn</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">}</span>

  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <h2>Controllers</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p><strong>ApplicationController</strong>: Handles controls at the application level.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">ApplicationController</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Controller</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Whether the instructions are being displayed.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">instructionsVisible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Toggle displaying the instructions.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">toggleInstructions</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">toggleProperty</span><span class="p">(</span><span class="s1">&#39;instructionsVisible&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p><strong>BoardController</strong>: handles all interaction with the game board.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">BoardController</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">ObjectController</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>By default, there is no game in progress.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">inProgress</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Do we want to show 'CLEAR' button?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">showClearWord</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>The word needs to have at least one letter to be cleared.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.word&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;content.word.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Do we want to show the 'SUBMIT' button?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">showSubmitWord</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Word needs to be at least 2 letters long</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">return</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.word&#39;</span><span class="p">).</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;content.word.@each&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p><code>resign</code> is called when a player clicks the resign button.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">resign</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">finishGame</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>If we have a winner, the game is over</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">winnerChanged</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.winner&#39;</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;inProgress&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}.</span><span class="nx">observes</span><span class="p">(</span><span class="s1">&#39;content.winner&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p><code>submitWord</code> is called when the player clicks submit.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">submitWord</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>

      <span class="kd">var</span> <span class="nx">w</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.wordAsString&#39;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>First, we need to see if the word is in our game's dictionary.
We use jQuery's handy $.inArray for this.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span> <span class="p">(</span><span class="nx">$</span><span class="p">.</span><span class="nx">inArray</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">EmberPressDictionary</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Sorry, that word isn&#39;t in the dictionary&quot;</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Secondly, we need to consider whether that word has already
been played. We unfortunately have to use a <code>forEach</code> for this,
as we do not allow roots of existing words either.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="kd">var</span> <span class="nx">unplayedWord</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.played&#39;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">word</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">word</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;value&#39;</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">w</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;That word can&#39;t be played.&quot;</span><span class="p">);</span>
          <span class="nx">unplayedWord</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">unplayedWord</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Note that this turn wasn't skipped.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;skipped&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Finally, submit the word to the <code>Board</code> model.</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">submitWord</span><span class="p">();</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>When a user chooses to skip their turn.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">skipTurn</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;skipped&#39;</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>If the previous player also skipped their turn, the game
is now over.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">finishGame</span><span class="p">();</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Otherwise, skip to the next turn.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;skipped&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">nextTurn</span><span class="p">();</span>
      <span class="p">}</span>
    <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>When we want to start a new game on this board.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">reset</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;skipped&#39;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">).</span><span class="nx">restart</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;inProgress&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <h2>Views</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p><strong>BoardView</strong>: Used to render the board from a template.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">BoardView</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span><span class="nx">templateName</span><span class="o">:</span> <span class="s1">&#39;board&#39;</span><span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p><strong>LetterView</strong>: Represents a <code>Letter</code> either on the board, or in the current
word being assembled.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">LetterView</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">classNameBindings</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;:letter&#39;</span><span class="p">,</span> <span class="s1">&#39;chosen&#39;</span><span class="p">,</span> <span class="s1">&#39;ownerClass&#39;</span><span class="p">,</span> <span class="s1">&#39;content.fortified&#39;</span><span class="p">],</span>
    <span class="nx">boardBinding</span><span class="o">:</span> <span class="s1">&#39;controller.content&#39;</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Set the CSS class to be the id of the current <code>Letter</code>, if present.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">ownerClass</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">owner</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.owner&#39;</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">owner</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="kc">null</span><span class="p">;</span> <span class="p">}</span>
      <span class="k">return</span> <span class="nx">owner</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;content.owner&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>No need for a template for one letter!</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">render</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">buffer</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">buffer</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.letter&#39;</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p><strong>WordLetterView</strong>: is the word being assembled.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">WordLetterView</span> <span class="o">=</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">LetterView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>If the player clicks a letter in the word, we remove it.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">click</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board&#39;</span><span class="p">).</span><span class="nx">removeLetter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">));</span>
    <span class="p">}</span>

  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p><strong>BoardLetterView</strong>: A <code>LetterView</code> that is displayed on the board.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">BoardLetterView</span> <span class="o">=</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">LetterView</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>Has this letter been chosen?</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">chosen</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board.word&#39;</span><span class="p">).</span><span class="nx">findProperty</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content.id&#39;</span><span class="p">))</span> <span class="o">?</span> <span class="kc">true</span> <span class="o">:</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">property</span><span class="p">(</span><span class="s1">&#39;board.word.@each.id&#39;</span><span class="p">),</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>The player clicked on a letter, so we want to add it to our word.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">click</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;chosen&#39;</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;board&#39;</span><span class="p">).</span><span class="nx">addLetter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p><strong>PlayerView</strong>: Render a player with their scores.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">PlayerView</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">classNameBindings</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;:player&#39;</span><span class="p">,</span> <span class="s1">&#39;content.id&#39;</span><span class="p">,</span> <span class="s1">&#39;content.isTurn&#39;</span><span class="p">],</span>
    <span class="nx">templateName</span><span class="o">:</span> <span class="s1">&#39;player&#39;</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>Boilerplate below initializes the game. Routers make more sense
when there is more than one URL :)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">IndexRoute</span> <span class="o">=</span> <span class="nx">Ember</span><span class="p">.</span><span class="nx">Route</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">setupController</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="kd">var</span> <span class="nx">board</span> <span class="o">=</span> <span class="nx">EmberPress</span><span class="p">.</span><span class="nx">Board</span><span class="p">.</span><span class="nx">create</span><span class="p">();</span>
      <span class="nx">board</span><span class="p">.</span><span class="nx">restart</span><span class="p">();</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">controllerFor</span><span class="p">(</span><span class="s1">&#39;board&#39;</span><span class="p">).</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">,</span> <span class="nx">board</span><span class="p">);</span>
    <span class="p">},</span>

    <span class="nx">renderTemplate</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">&#39;board&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">}());</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 